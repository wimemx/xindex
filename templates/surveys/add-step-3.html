<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <title>Agregar Encuesta</title>
    <meta name="description"
          content="app, web app, responsive, admin dashboard, admin, flat, flat ui, ui kit, off screen nav">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/static/css/bootstrap.css">
    <link rel="stylesheet" href="/static/css/animate.css">
    <link rel="stylesheet" href="/static/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/css/font.css" cache="false">
    <link rel="stylesheet" href="/static/css/plugin.css">
    <link rel="stylesheet" href="/static/css/app.css">
    <link rel="stylesheet" href="/static/dzcss/basic.css">
    <link rel="stylesheet" href="/static/dzcss/dropzone.css">
    <style>
        section.selected-block {
            border: 2px solid #00c7f7 !important;
        }
        section.question-block {
            border: 2px dashed transparent;
            border-radius: 5px;
        }
        section.question-block:hover{
            border: 2px dashed #285e8e;
        }

        section.question-block:hover {
            cursor: pointer;
        }

        div.active-question {
            border: 2px solid #4cae4c;
        }

        #holder {
            border: 1px dashed #ccc;
            width: 100%;
            min-height: 100%;
            margin: 10px auto;
        }

        #holder.hover {
            border: 1px dashed #0c0;
        }

        #holder img {
            display: block;
            margin: 10px auto;
        }

        #holder p {
            margin: 20px;
            font-size: 14px;
        }

        progress {
            width: 100%;
        }

        progress:after {
            content: '%';
        }

        .fail {
            background: #c00;
            padding: 2px;
            color: #fff;
        }

        .hidden {
            display: none !important;
        }
    </style>
    <!--[if lt IE 9]>
    <script src="js/ie/respond.min.js" cache="false"></script>
    <script src="js/ie/html5.js" cache="false"></script>
    <script src="js/ie/fix.js" cache="false"></script>
  <![endif]-->

</head>
<body>
<section class="vbox stretch bg-white">
<header class="yellow-xindex-nohover text-center wrapper header">
    <div class="row">
        <div class="pull-left padder">
            <a href="/xindex/">
            {% load staticfiles %}
            <img src="{% static "images/xindex-logo.png" %}" alt="XINDEX Home"/>
            </a>
        </div>
        <div class="h4 pull-left padder" style=" border-left: 2px solid #d3d3d3">
            Generador de encuestas
        </div>
        <div class="pull-right padder" style=" border-left: 2px solid #d3d3d3">
            <a class="h5" id="save-link"
               href="/surveys/save/exit/{{ survey_id }}">X</a>
        </div>
        <div class="pull-right padder" style=" border-left: 2px solid #d3d3d3">
            <a class="h5" id="save-link"
               href="/surveys/save/exit/{{ survey_id }}">Guardar y Salir</a>
        </div>
        <div class="pull-right padder">
            <a class="h5" id="save-link"
               href="/surveys/save/exit/{{ survey_id }}">Preview</a>
        </div>
    </div>
</header>
<section class="scrollable wrapper">
<div class="row">
<input type="hidden" value="{{ survey_id }}" id="survey_id"/>
<div class="col-lg-6">
    <section class="panel">
        <div class="panel-body">
            <section class="header text-center panel visible-lg border-dropzone">

                <form id="picture" class="dropzone" action="/surveys/media_upload/{{ survey_id }}">
                    {% csrf_token %}
                    <input type="hidden" name="picture" value="1"/>
                        <div class="preview grid-5 fright no-margin dropzone-previews">
                    </div>
                </form>
                <!--
                <small>
                <i class="icon-github-alt icon-5x"></i><br>
                    Arrastra una imagen aquí<br> o <br>
                <div class="media-boody">
                <a class="file-input-wrapper btn btn btn-sm btn-info m-b-sm">
                Sube una imagen
                <form action="/surveys/{{ survey_id }}/saveimage" method="post">
                {% csrf_token %}
                <input class="btn btn-sm btn-info m-b-sm" type="file" title="Agregar" name="file" id="file"
                style="left: -233.25px; top: -4.5px; display: none" onchange="this.form.submit()"/>
                </form>
                </a>
                </div>
                </small>
                -->
            </section>
            <section class="panel wrapper" id="survey-main-content">
                <div class="row">
                    <div class="col-lg-12">
                        <section class="panel">
                            <div class="panel-body">
                                <header class="h3 text-center">
                                    {{ survey_title }}
                                </header>
                                <small class="wrapper">
                                    <p>
                                        Este es un texto de
                                        introducci&oacute;n o
                                        instrucciones para llenar tu
                                        encuesta, da click aqu&iacute;
                                        para editar este texto
                                    </p>
                                </small>
                            </div>
                        </section>
                    </div>
                </div>
                {% if setup %}
                    {% for block in setup.blocks %}
                        <div class="row row-block animated rollIn {% if not block.block_default_class %}row-no-block{% endif %}" id="{{ block.block_id }}">
                            <div class="col-lg-12">
                                <section class="padder padder-v question-block">
                                    <div class="block_actions" style="clear: both;">
                                        {% csrf_token %}
                                        <a class="actions_block" id="remove_block">
                                            <i class="icon-trash icon-large pull-right"></i>
                                        </a>
                                        <a class="actions_block" id="update_block">
                                            <i class="icon-edit icon-large pull-right"></i>
                                        </a>
                                    </div>
                                    <div class="panel-body">
                                        {{ block.block_description|safe }}
                                    </div>
                                    {% for question in block.questions %}
                                        <div class="wrapper question-content" style="display: table; min-width: 100%; min-heigth: 50px;" id="{{ question_content_id }}">
                                            <div class="question_id" style="float:left;">{{ question.survey_question_id }}</div>
                                            <div class="question-text" style="float: left; margin-left: 5px; display: table;">{{ question.question_title }}</div>
                                            <div class="optional-content" style="margin-top: 15px; clear: both;">
                                            {% if question.question.type.name == "Multiple Choice" %}
                                                {% for option in question.question_options %}
                                                    {% if option.option.active %}
                                                        {% if option.option.label != "" %}
                                                            <input type="radio" name="{{ question.question.id }}" value="{{ option.option.value }}"> {{ option.option.label }}
                                                        {% else %}
                                                            <input type="radio" name="{{ question.question.id }}" value="{{ option.option.value }}"> {{ option.option.label }}
                                                        {% endif %}
                                                    {% endif %}
                                                {% endfor %}
                                            {% elif question.question.type.name == "False and True" %}
                                                {% for option in question.question.option_set.all %}
                                                    <input type="radio" name="{{ question.question.id }}" value="{{ option.value }}"> {{ option.label }}<br>
                                                {% endfor %}
                                            {% elif question.question_type == 3 %}
                                                {% for option in question.question_options %}
                                                    <input type="checkbox"/>{{ option.text }}<br>
                                                {% endfor %}
                                            {% elif question.question.type.name == 'Matrix'%}
                                                {% for row in question.question.question_set.all %}
                                                    {% if row.active %}
                                                        <label><b>{{ row.title }}</b></label>
                                                    {% endif %}

                                                    {% for option in row.option_set.all %}
                                                        {% if option.active %}
                                                            <input type="radio" name="{{ row.id }}" value="{{ option.value }}"> {{ option.label }}
                                                        {% endif %}
                                                    {% endfor %}
                                                <br>
                                                {% endfor %}
                                            {% elif question.question.type.name == "Open Question" %}
                                                <textarea name="comment" cols="30" rows="5"  maxlength="100"></textarea>
                                            {% elif question.question.type.name == "Range" %}
                                                {% for option in question.question_options %}
                                                    {% if option.option.active %}
                                                        {% if option.option.label != "" %}
                                                            <input type="radio" name="{{ question.question.id }}" value="{{ option.option.value }}"> {{ option.option.label }}
                                                        {% else %}
                                                            <input type="radio" name="{{ question.question.id }}" value="{{ option.option.value }}"> {{ option.option.label }}
                                                        {% endif %}
                                                    {% endif %}
                                                {% endfor %}
                                            {% endif %}
                                            </div>
                                            <div class="db_question_id" id="{{ question.db_question_id }}"></div>
                                        </div>
                                    {% endfor %}
                                    {% if block.block_default_class %}
                                        <footer class="wrapper text-center">
                                            <a class="btn btn-info wrapper add-question-to-block">
                                                <i class="icon-plus-sign-alt"></i>
                                                Da click aquí para añadir una pregunta</a>
                                        </footer>
                                    {% endif %}
                                </section>
                            </div>
                            </div>
                    {% endfor %}
                {% endif %}
            </section>
        </div>
        <div class="row default-buttons">
            <section class="default-buttons">
                <div class="wrapper text-center">
                    <a href="#"
                       class="btn btn-success dker text-center padder padder-v"
                       id="add-block-questions">
                        <i class="icon-plus-sign-alt icon-xlarge"></i>
                        Da click aqu&iacute; para añadir
                        un
                        bloque de preguntas
                    </a>
                    <a href="#"
                       class="btn btn-info dker text-center padder padder-v"
                       id="add-question">
                        <i class="icon-plus-sign-alt icon-xlarge"></i>
                        Da click aqu&iacute; para añadir una
                        pregunta
                    </a>
                </div>
            </section>
        </div>
        <section class="text-left panel-footer" style="border: none !important;">
            <section class="text-left">
                <div class="wrapper border-edit-survey padder">
                    <label class="h5"><strong>{{ company_name }}</strong></label><br>
                    <label class="h5">{{ company_address }}</label><br>
                    <label class="h5">{{ company_email }}</label><br>
                    <label class="h5">{{ company_phone }}</label>
                </div>
            </section>
        </section>
    </section>
</div>
<div class="col-lg-6">
<section class="panel" id="main-configuration-panel">
    <header class="panel-heading bg-light">
        <ul class="nav nav-tabs nav-justified">
            <li class="active"><a data-toggle="tab"
                                  href="#content">
                Contenido
            </a></li>
            <li class=""><a data-toggle="tab" href="#design">
                Diseño
            </a></li>
        </ul>
    </header>
    <div class="panel-body">
        <div class="tab-content">
            <div id="content" class="tab-pane active">
                <div class="col-lg-4">
                    <section class="panel">
                        <div class="panel-body text-center">
                            <i class="icon-list-alt icon-5x"></i>
                        </div>
                        <div class="footer text-center bg-gradient b-t">
                            <p class="h4">
                                Bloque de preguntas
                            </p>
                        </div>
                    </section>
                </div>
                <div class="col-lg-4">
                    <section class="panel">
                        <div class="panel-body text-center">
                            <i class="icon-list-ul icon-5x"></i>
                        </div>
                        <div class="footer text-center bg-gradient b-t">
                            <p class="h4">
                                Pregunta
                            </p>
                        </div>
                    </section>
                </div>
                <div class="col-lg-4">
                    <section class="panel">
                        <div class="panel-body text-center">
                            <i class="icon-picture icon-5x"></i>
                        </div>
                        <div class="footer text-center bg-gradient b-t">
                            <p class="h4">
                                Imagen
                            </p>
                        </div>
                    </section>
                </div>
                <div class="col-lg-4">
                    <section class="panel">
                        <div class="panel-body text-center">
                            <i class="icon-align-justify icon-5x"></i>
                        </div>
                        <div class="footer text-center bg-gradient b-t">
                            <p class="h4">
                                Bloque de texto
                            </p>
                        </div>
                    </section>
                </div>
            </div>
            <div id="design" class="tab-pane">
                profile
            </div>
        </div>
    </div>
</section>
<section class="panel hidden" id="questions-block-configuration-panel">
    <div class="wrapper text-center">
        <p class="h3">Bloque de Preguntas</p>
    </div>
    <header class="panel-heading bg-light">
        <ul class="nav nav-tabs nav-justified">
            <li class="active h4"><a data-toggle="tab"
                                     href="#content-by-block">
                Contenido
            </a></li>
            <li class="h4"><a data-toggle="tab" href="#block-design">
                Diseño
            </a></li>
            <li class="h4"><a data-toggle="tab" href="#block-configuration">
                Configuraci&oacute;n
            </a></li>
        </ul>
    </header>
    <div class="panel-body">
        <div class="tab-content">
            <div id="content-by-block" class="tab-pane active">
                <input type="hidden" id="current-question-block" value=""/>

                <div class="col-lg-12 wrapper">
                    <section class="panel">
                        <textarea id="tinymce-editor" name="tinymce-editor">

                        </textarea>
                    </section>
                </div>
            </div>
            <div id="block-design" class="tab-pane">
                <h1>Diseño del bloque</h1>
            </div>
            <div id="block-configuration" class="tab-pane">
                
            </div>
        </div>
    </div>
</section>
<section class="panel hidden" id="add-question-option-panel">
    <div class="wrapper text-center">
        <p class="h3">Añadir una pregunta</p>
    </div>
    <div class="panel-body">
        <div class="wrapper text-center">
            <a href="#"
               class="btn wrapper h4 btn-success btn-create-new-question">Crear
                una nueva pregunta</a>
        </div>
        <div class="wrapper text-center">
            <p>o</p>
        </div>
        <div class="wrapper text-center">
            <a href="#" class="btn wrapper h4 btn-info">Seleccionar de un
                banco de preguntas</a>
        </div>
    </div>
</section>
<section class="panel hidden" id="add-new-question-configuration-panel">
    <div class="wrapper text-center">
        <p class="h3">Añadir una pregunta</p>
    </div>
    <header class="panel-heading bg-light">
        <ul class="nav nav-tabs nav-justified">
            <li class="active h4"><a data-toggle="tab"
                                     href="#content-by-block">
                Contenido
            </a></li>
            <li class="h4"><a data-toggle="tab" href="#design">
                Diseño
            </a></li>
            <li class="h4"><a data-toggle="tab" href="#design">
                Configuraci&oacute;n
            </a></li>
        </ul>
    </header>
    <div class="panel-body">
        <div class="tab-content">
            <div id="content-by-block" class="tab-pane active">
                <input type="hidden" id="current-question" value=""/>

                <div class="col-lg-12 wrapper">
                    <section class="panel wrapper">
                        <div class="">
                            <p class="h4">Texto de la pregunta</p>
                        </div>
                        <textarea id="tinymce-editor-new-question"
                                  name="tinymce-editor-new-question">

                        </textarea>

                        <div class="padder-v">
                            <header>
                                <p class="h4">Tipo de pregunta</p>
                            </header>
                            <section>
                                <select name="question_type_select"
                                        id="question_type_select">
                                    {% for type in question_types %}
                                        <option value="{{ type.id }}">{{ type.help_text }}</option>
                                    {% endfor %}
                                </select>
                            </section>
                            <div>
                                <div id="question_type_1" style="display: none"
                                     style="display: inline"
                                     class='question matrix'>
                                    <form id='question_type_1_form'>{% csrf_token %}
                                        <input class="question-title matrix_title" type="hidden" name="m_title" maxlength="100" />
                                        <p>Set the name of the columns</p>

                                        <div class="matrix_cols">
                                            <input type="text" maxlength="100"
                                                   class="dummy_option"
                                                   value='Click to add another column'/>
                                        </div>
                                        <p>Set each one of the rows</p>

                                        <div class="matrix_rows">
                                            <input type="text" maxlength="100"
                                                   class="dummy_option"
                                                   value='Click to add another row'/>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="add-m-to-catalog"/> Agregar al catalogo de preguntas
                                        </div>
                                        <input id="add_matrix" type="submit"
                                               value="Add Question"/>
                                    </form>
                                </div>

                                <div id="question_type_2" style="display: none"
                                     class='question multiple_choice'>
                                    <form id='question_type_2_form'>{% csrf_token %}
                                        <p>Options</p>
                                        <input class="question-title multiple_choice_title" type="hidden" name="mo_title" maxlength="100" />
                                        <div class="multiple_choice_options_set">
                                            <input type="text" maxlength="100"
                                                   class="dummy_option"
                                                   value='Click to add another option'/>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="add-mc-to-catalog"/> Agregar al catalogo de preguntas
                                        </div>
                                        <div>
                                            <input id="add_multiple_choice"
                                               type="submit"
                                               value="Add Question"/>
                                        </div>

                                    </form>
                                </div>

                                <div id="question_type_3" style="display: none"
                                     class='question open_question'>
                                    <form id='question_type_3_form'>{% csrf_token %}
                                        <input class="question-title open_question_title" type="hidden" name="oq_title" maxlength="100" />
                                        <div>
                                            <input type="checkbox" id="add-o-to-catalog"/> Agregar al catalogo de preguntas
                                        </div>
                                        <input id="add_open_question"
                                               type="submit"
                                               value="Add Question"/>
                                    </form>
                                </div>

                                <div id="question_type_4" style="display: none"
                                     class='question range'>
                                    <form id='question_type_4_form'>{% csrf_token %}
                                        <input class="question-title range_title" type="hidden" name="r_title" maxlength="100" />
                                        <p>Set each one of the information</p>

                                        <div class="range_field_set">
                                            <label>Start value:</label><input
                                                type="text" maxlength="100"
                                                class="start_number"/>
                                            <label>Start label:</label><input
                                                type="text" maxlength="100"
                                                class="start_label"/>

                                            <label>End value:</label><input
                                                type="text" maxlength="100"
                                                class="end_number"/>
                                            <label>End Label:</label><input
                                                type="text" maxlength="100"
                                                class="end_label"/>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="add-r-to-catalog"/> Agregar al catalogo de preguntas
                                        </div>
                                        <input id="add_range_question"
                                               type="submit"
                                               value="Add Question"/>
                                    </form>
                                </div>

                                <div id="question_type_5"
                                     class='question true_and_false'>
                                    <form id='question_type_5_form'>{% csrf_token %}
                                        <input class="question-title true_and_false_title" type="hidden" name="taf_title" maxlength="100" />
                                        <div>
                                            <input type="checkbox" id="add-tf-to-catalog"/> Agregar al catalogo de preguntas
                                        </div>
                                        <input id="add_true_and_false_question"
                                               type="submit"
                                               value="Add Question"/>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
            <div id="design" class="tab-pane">
                profile
            </div>
        </div>
    </div>
</section>
</div>
</div>
</section>
</section>
<script src="/static/js/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="/static/js/bootstrap.js"></script>
<!-- Sparkline Chart -->
<script src="/static/js/charts/sparkline/jquery.sparkline.min.js"></script>
<!-- App -->
<script src="/static/js/app.js"></script>
<script src="/static/js/app.plugin.js"></script>

<!-- TinyMCE -->
<script type="text/javascript" src="/static/js/tinymce/tinymce.min.js"></script>

<!-- Survey App -->
<script src="/static/js/survey.app.js"></script>

<!-- Dropzone -->
<script src="/static/js/dropzone.js"></script>

<!-- question selector -->
<script src="/static/js/questions_survey_selector.js"></script>

<!-- Dropzone conf -->

<!-- BootBox -->
<script src="/static/js/bootbox/bootbox.min.js"></script>
<script>
       Dropzone.options.picture = {
       maxFiles: 1,
       dictDefaultMessage: 'Arrastre una imagen aquí o',
       dictRemoveFile: 'Eliminar',
       addRemoveLinks: true,
       init: function() {
           this.on("addedfile", function(file) {
               $('#picture .dz-message').fadeOut(300);
           });
       }
   }
</script>
</body>
</html>